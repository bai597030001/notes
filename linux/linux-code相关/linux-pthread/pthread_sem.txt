libutility.so-->threadpool.h-->ĞÅºÅÁ¿µÄÓ¦ÓÃ


#include <stdio.h>
#include <string.h>
#include <pthread.h>
#include <semaphore.h>
int seats = 5;
pthread_mutex_t m = PTHREAD_MUTEX_INITIALIZER;
sem_t s;
void* people (void* arg) {
	pthread_t tid = pthread_self ();
	sem_wait (&s);
	pthread_mutex_lock (&m);
	printf ("%luåä¸‹ï¼Œè¿˜å‰?dä¸ªç©ºåº§\n", tid, --seats);
	pthread_mutex_unlock (&m);
	usleep (500000);
	pthread_mutex_lock (&m);
	printf ("%luä¸‹è½¦ï¼Œè¿˜å‰?dä¸ªç©ºåº§\n", tid, ++seats);
	pthread_mutex_unlock (&m);
	sem_post (&s);
	return NULL;
}
int main (void) {
	sem_init (&s, 0, seats);
	printf ("å‘è½¦æ—¶æœ‰%dä¸ªç©ºåº§\n", seats);
	int i;
	pthread_t tids[20];
	for (i = 0; i < 20; ++i)
		pthread_create (&tids[i], NULL, people, NULL);
	for (i = 0; i < 20; ++i)
		pthread_join (tids[i], NULL);
	printf ("æ”¶è½¦æ—¶æœ‰%dä¸ªç©ºåº§\n", seats);
	sem_destroy (&s);
	return 0;
}
